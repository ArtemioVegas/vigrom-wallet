# Тестовый проект для Vigrom

## Как запустить

Клонируем себе репозиторий:

```
git clone https://github.com/ArtemioVegas/vigrom-wallet.git
```

В папке проекта запускаем:

```
make init
```

Приложение будет запущено на порту 8585.

По умолчанию в базе будет создано два кошелька: первый рублевый (ID = 1), второй долларовый (ID = 2).

## Как пользоваться

### Метод для изменения баланса

Пример:

```
POST http://localhost:8585/api/balance
Content-Type: application/json

{
    "walletId": 2,
    "amountInMinor": 48000,
    "reason": "stock",
    "type": "debit",
    "currency": "USD"
}
```

### Метод для получения текущего баланса

Пример:

```
http://localhost:8585/api/balance/1
```

## Комментарии от меня

* Приложение работает с финансами пользователей, поэтому по-хорошему в каком-то виде должен быть реализован механизм авторизации, чтобы баланс не редактировался кем попало. В задании про это ничего сказано не было, поэтому тут я ничего додумывать не стал.

## SQL запрос

```SQL
SELECT SUM(amount) FROM transaction WHERE reason = 'refund' AND created_at > NOW() - interval '7 days';
```

* Из задания не было понятно, требуется ли получить данные для конкретного кошелька или вообще для всех кошельков в системе. Я сделал для всех кошельков.

* Здесь сделано допущение, что валюта кошелька постоянна. Я предположил, что в реальном приложении это бы работало именно так — для новой валюты просто создавался бы новый кошелек. Иначе было бы много нюансов с пересчетом курса (в какой момент пересчитывать, как быть с новыми валютами и т. д.).   
